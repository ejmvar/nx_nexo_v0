# ============================================================================
# AlertManager Notification Configuration
# ============================================================================
# Copy this file to .env and fill in your actual credentials
# File location: observability/.env
#
# After configuring, restart AlertManager:
#   docker compose -f docker-compose.observability.yml restart alertmanager
# ============================================================================

# ============================================================================
# SLACK WEBHOOK URLS
# ============================================================================
# Create Slack webhooks at: https://api.slack.com/messaging/webhooks
# 
# Steps to create Slack webhook:
# 1. Go to https://api.slack.com/apps
# 2. Click "Create New App" → "From scratch"
# 3. Name: "NEXO AlertManager", select your workspace
# 4. Click "Incoming Webhooks" → Enable webhooks
# 5. Click "Add New Webhook to Workspace"
# 6. Select channel (e.g., #alerts-critical)
# 7. Copy the webhook URL
# 
# Recommended channels:
# - #alerts-critical      - For critical severity alerts
# - #alerts-warnings      - For warning severity alerts  
# - #alerts-infrastructure - For database/cache/queue alerts

# Critical alerts webhook (fires to #alerts-critical)
SLACK_WEBHOOK_URL_CRITICAL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL_CRITICAL

# Warning alerts webhook (fires to #alerts-warnings)
SLACK_WEBHOOK_URL_WARNINGS=https://hooks.slack.com/services/YOUR/WEBHOOK/URL_WARNINGS

# Infrastructure alerts webhook (fires to #alerts-infrastructure)
SLACK_WEBHOOK_URL_INFRASTRUCTURE=https://hooks.slack.com/services/YOUR/WEBHOOK/URL_INFRASTRUCTURE


# ============================================================================
# EMAIL SMTP CONFIGURATION
# ============================================================================
# Choose your email provider and configure accordingly

# ----------------------------------------------------------------------------
# Option 1: Gmail (recommended for testing)
# ----------------------------------------------------------------------------
# 1. Go to https://myaccount.google.com/apppasswords
# 2. Generate an "App Password" for "Mail"
# 3. Use the 16-character password below (not your Gmail password!)

# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-16-char-app-password
# ALERT_EMAIL_FROM=alerts@nexo-crm.com

# ----------------------------------------------------------------------------
# Option 2: SendGrid
# ----------------------------------------------------------------------------
# 1. Sign up at https://sendgrid.com
# 2. Create API key with "Mail Send" permissions
# 3. Use "apikey" as username, API key as password

# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASSWORD=SG.your_sendgrid_api_key_here
# ALERT_EMAIL_FROM=alerts@nexo-crm.com

# ----------------------------------------------------------------------------
# Option 3: Mailgun
# ----------------------------------------------------------------------------
# 1. Sign up at https://www.mailgun.com
# 2. Add your domain or use sandbox domain
# 3. Get SMTP credentials from "Sending" → "Domain settings" → "SMTP credentials"

# SMTP_HOST=smtp.mailgun.org
# SMTP_PORT=587
# SMTP_USER=postmaster@your-domain.mailgun.org
# SMTP_PASSWORD=your_mailgun_smtp_password
# ALERT_EMAIL_FROM=alerts@nexo-crm.com

# ----------------------------------------------------------------------------
# Option 4: AWS SES
# ----------------------------------------------------------------------------
# 1. Set up AWS SES in your region
# 2. Verify your sender email address
# 3. Create SMTP credentials from "SMTP settings"

# SMTP_HOST=email-smtp.us-east-1.amazonaws.com
# SMTP_PORT=587
# SMTP_USER=your_aws_ses_smtp_username
# SMTP_PASSWORD=your_aws_ses_smtp_password
# ALERT_EMAIL_FROM=alerts@nexo-crm.com

# ----------------------------------------------------------------------------
# Current Configuration (fill these in with your chosen provider)
# ----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password-here
ALERT_EMAIL_FROM=alerts@nexo-crm.com

# Email recipients for different alert types
ALERT_EMAIL_TO_CRITICAL=oncall@nexo-crm.com
ALERT_EMAIL_TO_WARNINGS=team@nexo-crm.com
ALERT_EMAIL_TO_INFRASTRUCTURE=devops@nexo-crm.com


# ============================================================================
# GRAFANA CREDENTIALS (Optional - for dashboard access)
# ============================================================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin  # Change this in production!


# ============================================================================
# TESTING NOTIFICATION CHANNELS
# ============================================================================
# After configuring the above, test your notifications:
#
# 1. Restart AlertManager to load new configuration:
#    docker compose -f docker/docker-compose.observability.yml restart alertmanager
#
# 2. Send a test alert:
#    curl -X POST http://localhost:9093/api/v1/alerts -H "Content-Type: application/json" -d '[
#      {
#        "labels": {
#          "alertname": "TestAlert",
#          "service": "test",
#          "severity": "warning"
#        },
#        "annotations": {
#          "summary": "This is a test alert",
#          "description": "Testing notification channels for NEXO CRM monitoring"
#        }
#      }
#    ]'
#
# 3. Check your Slack channels and email inbox for the test alert
#
# 4. If test succeeds, run real alert tests:
#    ./observability/scripts/test-alerts.sh manual
#
# ============================================================================
# SECURITY NOTES
# ============================================================================
# - NEVER commit the .env file with real credentials to git
# - The .env file is already in .gitignore
# - Use environment-specific .env files (.env.dev, .env.prod)
# - In production, use secrets management (AWS Secrets Manager, HashiCorp Vault)
# - Rotate SMTP passwords and webhook URLs regularly
# - Limit Slack webhook permissions to posting only
# - Use dedicated email accounts for alerts
# ============================================================================
