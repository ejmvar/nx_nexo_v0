# ==============================================================================
# QA (Staging) Environment Configuration
# ==============================================================================
# This file is for QA/STAGING testing in Docker containers (ports 6xxx).
# Copy this file to .env.qa and adjust values with REAL secrets.
#
# ⚠️ WARNING: Use STRONG passwords and secrets for QA environment.
# This environment should closely mirror PRODUCTION configuration.
# ==============================================================================

# ----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# ----------------------------------------------------------------------------
POSTGRES_DB=nexo_qa
POSTGRES_USER=nexo_user
POSTGRES_PASSWORD=changeme-use-strong-password  # ⚠️ CHANGE THIS

# PostgreSQL Connection URL (used by backend services)
DATABASE_URL=postgresql://nexo_user:changeme-use-strong-password@nexo-postgres-qa:5432/nexo_qa

# ----------------------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------------------
REDIS_HOST=nexo-redis-qa
REDIS_PORT=6379
REDIS_PASSWORD=changeme-use-strong-password  # ⚠️ CHANGE THIS

# ----------------------------------------------------------------------------
# JWT Configuration
# ----------------------------------------------------------------------------
JWT_SECRET=changeme-use-strong-jwt-secret  # ⚠️ CHANGE THIS (min 32 chars)
JWT_EXPIRES_IN=30m   # Shorter expiry for staging
JWT_REFRESH_EXPIRES_IN=7d

# ----------------------------------------------------------------------------
# Service URLs (Internal Docker Network)
# ----------------------------------------------------------------------------
AUTH_SERVICE_URL=http://nexo-auth-service-qa:3001
CRM_SERVICE_URL=http://nexo-crm-service-qa:3003
API_GATEWAY_URL=http://nexo-api-gateway-qa:3002

# Frontend Public API URL (External Access)
NEXT_PUBLIC_API_URL=http://localhost:6002

# ----------------------------------------------------------------------------
# Environment Settings
# ----------------------------------------------------------------------------
NODE_ENV=staging     # Staging mode (production-like)
LOG_LEVEL=info       # Moderate logging

# ----------------------------------------------------------------------------
# Monitoring & Observability
# ----------------------------------------------------------------------------
ENABLE_METRICS=true
ENABLE_TRACING=true
SENTRY_DSN=https://your-sentry-dsn-here@sentry.io/project  # ⚠️ CHANGE THIS
SENTRY_ENVIRONMENT=qa

# APM Configuration (optional)
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_APP_NAME=nexo-qa

# ----------------------------------------------------------------------------
# File Storage Configuration
# ----------------------------------------------------------------------------
FILE_STORAGE_TYPE=local  # or minio, s3, azure, gcp
FILE_STORAGE_NAME=nexo-qa-storage
FILE_STORAGE_BASE_PATH=/app/media
FILE_STORAGE_ID=
FILE_STORAGE_DESC={}

# If using S3/MinIO:
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# S3_BUCKET_NAME=nexo-qa-uploads

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100       # Requests per window
RATE_LIMIT_WINDOW=60000  # 1 minute

# ----------------------------------------------------------------------------
# CORS Configuration
# ----------------------------------------------------------------------------
CORS_ORIGIN=http://localhost:6000,https://qa.nexo.example.com
CORS_CREDENTIALS=true

# ----------------------------------------------------------------------------
# Email Configuration (if using)
# ----------------------------------------------------------------------------
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@nexo.example.com
SMTP_PASSWORD=changeme  # ⚠️ CHANGE THIS
SMTP_FROM=noreply@nexo.example.com

# ----------------------------------------------------------------------------
# Backup Configuration
# ----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_PATH=/backups
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# ----------------------------------------------------------------------------
# Security Headers
# ----------------------------------------------------------------------------
HELMET_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_DIRECTIVES=default-src 'self'

# ----------------------------------------------------------------------------
# Testing & Quality Assurance
# ----------------------------------------------------------------------------
# Allow test users in QA
ALLOW_TEST_USERS=true
# Require email verification
REQUIRE_EMAIL_VERIFICATION=false
# Enable feature flags
FEATURE_FLAGS_ENABLED=true
